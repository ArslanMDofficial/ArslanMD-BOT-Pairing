<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WhatsApp Bot Pairing - Arslan MD</title>
<style>
  body { font-family: Arial, sans-serif; background:#222; color:#eee; text-align:center; padding:2rem; }
  #qr { margin-top: 20px; }
  #status { margin-top: 15px; font-size: 1.2rem; }
  button { padding: 10px 20px; font-size: 1.1rem; cursor:pointer; border:none; border-radius:5px; background:#00C851; color:#fff; }
  button:disabled { background:#555; cursor:not-allowed; }
</style>
</head>
<body>
<h1>WhatsApp Bot Pairing - Arslan MD</h1>
<p>Click the button below to generate your WhatsApp QR code. Scan it with your WhatsApp to link.</p>
<button id="generateBtn">Generate QR Code</button>
<div id="status"></div>
<div id="qr"></div>

<script>
  const btn = document.getElementById('generateBtn');
  const qrDiv = document.getElementById('qr');
  const statusDiv = document.getElementById('status');

  btn.addEventListener('click', async () => {
    btn.disabled = true;
    qrDiv.innerHTML = '';
    statusDiv.textContent = 'Generating QR code... Please wait.';
    
    try {
      const res = await fetch('/generate-qr');
      if (!res.ok) throw new Error('Failed to get QR');
      const data = await res.json();
      if (data.qr) {
        const img = document.createElement('img');
        img.src = data.qr;
        img.alt = 'WhatsApp QR Code';
        img.style.maxWidth = '300px';
        qrDiv.appendChild(img);
        statusDiv.textContent = 'Scan this QR code with WhatsApp on your phone.';
      } else {
        statusDiv.textContent = 'No QR received, try again.';
      }
    } catch (err) {
      statusDiv.textContent = 'Error: ' + err.message;
    }
    btn.disabled = false;
  });
</script>
</body>
</html>
